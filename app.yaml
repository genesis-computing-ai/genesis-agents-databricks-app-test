# Databricks Apps configuration file
# This file defines the application specification for Databricks Apps deployment

# Command to launch the application
command:
  - python
  - app.py

# Environment variables
env:
  # Python configuration
  - name: PYTHONPATH
    value: "./workspace"
  
  - name: PYTHONUNBUFFERED
    value: "1"
  
  # Workspace directory (Databricks Apps provides this)
  - name: WORKSPACE_DIR
    valueFrom: volume
  
  # Port (Databricks Apps provides this via PORT environment variable)
  - name: PORT
    value: "8000"
  
  # Host binding
  - name: HOST
    value: "0.0.0.0"
  
  # OpenAI API Key from secret
  - name: OPENAI_API_KEY
    valueFrom: OPENAI_API_KEY

# Database configuration
# Use DB_ENV environment variable to switch between 'local' and 'databricks'
# Default is 'databricks' if not specified
#
# Supported database backends:
# - PostgreSQL (default, if 'type' field is not specified)
# - SQLite (set 'type: sqlite')
#
# To use a different backend, add a 'type' field to your database configuration:
#   type: postgresql  # or 'sqlite'
#
# For PostgreSQL, provide: host, port, database, user, password
# For SQLite, provide: database (file path, e.g., './todos.db')

# Databricks Postgres configuration (PostgreSQL backend)
database_databricks:
  # type: postgresql  # Optional, defaults to postgresql if not specified
  host: "instance-3af3a681-723d-4026-b9d0-2a29fc754893.database.cloud.databricks.com"
  port: 5432
  database: "databricks_postgres"
  user: "dev_user"
  password: "test12345"  # Consider using a secret in production

# Local Postgres configuration (for development)
database_local:
  # type: postgresql  # Optional, defaults to postgresql if not specified
  host: "localhost"
  port: 5432
  database: "antongorshkov"  # Change to your local database name if different
  user: "antongorshkov"      # Change to your local PostgreSQL user if different
  password: ""          # Set your local PostgreSQL password if required

# SQLite configuration (for local development)
# Set DB_ENV=sqlite to use SQLite instead of PostgreSQL
database_sqlite:
  type: sqlite
  database: "./todos.db"  # File path (relative or absolute)
